global
    chroot /var/lib/haproxy
    daemon
    group haproxy
    pidfile /var/run/haproxy.pid
    user haproxy
    master-worker

    # GLOBAL
    presetenv PROJECT_HOSTNAME dev.nirv.ai

    # NIRVAI/CORE-PROXY
    presetenv PROXY_AUTH_NAME nirvai
    presetenv PROXY_AUTH_PASS nirvai
    presetenv PROXY_MAXCONN_GLOBAL 1000
    presetenv PROXY_MAXCONN_HUMAN 10
    presetenv PROXY_MAXCONN_PRIV 100
    presetenv PROXY_MAXCONN_PUB 500
    presetenv PROXY_EDGE_PORT 8080
    presetenv PROXY_EDGE_RP_HTTP_PORT 8081
    presetenv PROXY_EDGE_RP_HTTPS_PORT 8443
    presetenv PROXY_EDGE_VAULT_PORT 8200
    presetenv PROXY_STATS_PORT 8404
    presetenv PROXY_VAULT_HOSTNAME web_vault
    presetenv PROXY_VAULT_PORT 8300

    # NIRVAI/WEB
    presetenv WEB_BFF_HOSTNAME web_bff
    presetenv WEB_BFF_PORT 3001
    presetenv WEB_UI_HOSTNAME web_ui
    presetenv WEB_UI_PORT 3000

    fd-hard-limit 50000
    profiling.tasks on
    stats socket /var/run/api.sock mode 660 level admin expose-fd listeners
    stats timeout 30s

    log stdout format raw local0 info
    lua-load /etc/haproxy/modules/cors.lua

    ssl-default-bind-ciphers ECDHE-ECDSA-AES256-GCM-SHA384:ECDHE-RSA-AES256-GCM-SHA384:ECDHE-ECDSA-CHACHA20-POLY1305:ECDHE-RSA-CHACHA20-POLY1305:ECDHE-ECDSA-AES128-GCM-SHA256:ECDHE-RSA-AES128-GCM-SHA256:ECDHE-ECDSA-AES256-SHA384:ECDHE-RSA-AES256-SHA384:ECDHE-ECDSA-AES128-SHA256:ECDHE-RSA-AES128-SHA256
    ssl-default-bind-options ssl-min-ver TLSv1.2
