global
    chroot  /var/lib/haproxy
    daemon
    group haproxy
    user haproxy

    fd-hard-limit 50000
    log stdout format raw local0 info
    lua-load /etc/haproxy/modules/cors.lua
    maxconn 1000
    pidfile /var/run/haproxy.pid
    ssl-default-bind-ciphers ECDHE-ECDSA-AES256-GCM-SHA384:ECDHE-RSA-AES256-GCM-SHA384:ECDHE-ECDSA-CHACHA20-POLY1305:ECDHE-RSA-CHACHA20-POLY1305:ECDHE-ECDSA-AES128-GCM-SHA256:ECDHE-RSA-AES128-GCM-SHA256:ECDHE-ECDSA-AES256-SHA384:ECDHE-RSA-AES256-SHA384:ECDHE-ECDSA-AES128-SHA256:ECDHE-RSA-AES128-SHA256
    ssl-default-bind-options ssl-min-ver TLSv1.2
    stats socket /var/run/api.sock mode 660 level admin expose-fd listeners
    stats timeout 30s


    presetenv PROXY_AUTH_NAME nirvai
    presetenv PROXY_AUTH_PASS nirvai
    presetenv PROXY_BFF_PORT 3001
    presetenv PROXY_EDGE_PORT 8080
    presetenv PROXY_EDGE_RP_HTTP_PORT 8081
    presetenv PROXY_EDGE_RP_HTTPS_PORT 8443
    presetenv PROXY_EDGE_VAULT_PORT 8200
    presetenv PROXY_STATS_PORT 8404
    presetenv PROXY_UI_PORT 3000
    presetenv PROXY_VAULT_PORT 8300

    presetenv PROJECT_HOST_NAME dev.nirv.ai
    # these wont work as the server hostnames are static
    presetenv BFF_SERVICE_NAME core_bff
    presetenv UI_SERVICE_NAME core_ui
    presetenv VAULT_SERVICE_NAME core_vault
